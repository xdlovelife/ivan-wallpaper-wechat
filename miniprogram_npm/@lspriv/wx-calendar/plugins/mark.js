"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MARK_PLUGIN_KEY=exports.MarkPlugin=void 0;const _=require("../interface/calendar");class e{update(e,t){const r=new Map;for(let e=0;e<t.length;e++){var a=t[e],s=a.date?(0,_.normalDate)(a.date):(0,_.normalDate)(+a.year,+a.month,+a.day),s=`${s.year}_${s.month}_`+s.day,o=r.get(s);o?"schedule"===a.type?o.schedule?o.schedule.push(a):o.schedule=[a]:o[a.type]=a:(o="schedule"===a.type?{schedule:[a]}:{[a.type]:a},r.set(s,o))}var l=this._marks_?[...this._marks_.entries()].flatMap(([e])=>r.has(e)?[]:(0,_.formDateByStrKey)(e)):[],n=[...r.keys()].map(e=>(0,_.formDateByStrKey)(e));this._marks_=r,e._loaded_&&e._calendar_.service.updateDates([...n,...l])}PLUGIN_TRACK_DATE(e){if(!this._marks_)return null;const r=`${e.year}_${e.month}_`+e.day;var t,e=this._marks_.get(r);return e?(t={},e.style&&(t.style=e.style.style),e.corner&&(t.corner={text:e.corner.text,color:e.corner.color}),e.festival&&(t.festival={text:e.festival.text,color:e.festival.color}),e.schedule&&(t.schedule=e.schedule.map((e,t)=>({text:e.text,color:e.color,bgColor:e.bgColor,key:(0,_.getMarkKey)(r,exports.MARK_PLUGIN_KEY)}))),t):null}PLUGIN_TRACK_SCHEDULE(e,t){return t?(t=e.month-1,{dtStart:new Date(e.year,t,e.day),dtEnd:new Date(e.year,t,e.day+1),origin:"component_prop_marks"}):null}}(exports.MarkPlugin=e).KEY="mark",exports.MARK_PLUGIN_KEY=e.KEY;